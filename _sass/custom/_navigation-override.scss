/* ==========================================================================
   RESPONSIVE NAVIGATION BAR OPTIMIZATION
   ========================================================================== */

/*
 * 响应式导航栏优化
 * 功能：
 * 1. 桌面端：水平布局，所有导航项可见
 * 2. 移动端：紧凑布局，可折叠汉堡菜单
 * 3. 平滑动画过渡
 * 4. 无障碍访问支持
 */

/* 全局配置变量 */
:root {
  --nav-mobile-breakpoint: 768px;
  --nav-transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  --nav-menu-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

/* ==========================================================================
   桌面端导航样式
   ========================================================================== */

/* 重置默认的贪婪导航行为 */
.greedy-nav {
  background: var(--global-bg-color);
  min-width: unset !important;
  position: relative;
}

/* 桌面端主要布局 */
@media (min-width: 769px) {
  .greedy-nav .visible-links {
    display: flex !important;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    table-layout: unset !important;
    padding: 0;
  }

  /* 重置原始的table布局 */
  .greedy-nav .visible-links li {
    display: flex !important;
    table-layout: unset !important;
    vertical-align: unset !important;
  }

  /* 网站标题固定在左侧 */
  .greedy-nav .visible-links .site-title {
    margin-right: auto;
    flex-shrink: 0;
  }

  .greedy-nav .visible-links .site-title a {
    font-weight: bold;
    font-size: 1.1em;
  }

  /* 导航项组在右侧 */
  .greedy-nav .visible-links .nav-item,
  .greedy-nav .visible-links .theme-toggle,
  .greedy-nav .visible-links .external-link {
    display: flex !important;
    margin-left: 1.5rem;
    white-space: nowrap;
  }

  /* 隐藏移动端菜单按钮 */
  .greedy-nav .mobile-menu-toggle {
    display: none !important;
  }

  /* 隐藏下拉菜单 */
  .greedy-nav .hidden-links {
    display: none !important;
  }

  /* 链接悬停效果 */
  .greedy-nav a:hover:before {
    transform: scaleX(1);
  }
}

/* ==========================================================================
   移动端导航样式
   ========================================================================== */

@media (max-width: 768px) {
  /* 移动端主容器 */
  .masthead {
    position: relative;
    z-index: 1000;
  }

  .greedy-nav {
    position: relative;
    padding: 0.75rem 1rem;
  }

  /* 移动端顶部栏：仅显示网站标题和汉堡按钮 */
  .greedy-nav .visible-links {
    display: flex !important;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    margin: 0;
    padding: 0;
  }

  /* 网站标题 */
  .greedy-nav .visible-links .site-title {
    display: flex !important;
    margin: 0;
    flex: 1;
  }

  .greedy-nav .visible-links .site-title a {
    font-weight: bold;
    font-size: 1.2em;
    margin: 0;
    padding: 0.5rem 0;
  }

  /* 移动端隐藏所有其他导航项 */
  .greedy-nav .visible-links .nav-item,
  .greedy-nav .visible-links .theme-toggle,
  .greedy-nav .visible-links .external-link {
    display: none !important;
  }

  /* 汉堡菜单按钮 */
  .greedy-nav .mobile-menu-toggle {
    display: flex !important;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    padding: 0;
    margin: 0;
    border: none;
    background: transparent;
    cursor: pointer;
    position: relative;
    z-index: 1001;
    transition: var(--nav-transition);
  }

  .greedy-nav .mobile-menu-toggle:hover {
    background: var(--global-bg-color-secondary, rgba(0, 0, 0, 0.05));
    border-radius: 4px;
  }

  /* 汉堡图标样式 */
  .greedy-nav .mobile-menu-toggle .navicon {
    position: relative;
    width: 20px;
    height: 2px;
    background: var(--global-masthead-link-color);
    display: block;
    transition: var(--nav-transition);
    border-radius: 1px;
  }

  .greedy-nav .mobile-menu-toggle .navicon:before,
  .greedy-nav .mobile-menu-toggle .navicon:after {
    content: '';
    position: absolute;
    left: 0;
    width: 20px;
    height: 2px;
    background: var(--global-masthead-link-color);
    transition: var(--nav-transition);
    border-radius: 1px;
  }

  .greedy-nav .mobile-menu-toggle .navicon:before {
    top: -6px;
  }

  .greedy-nav .mobile-menu-toggle .navicon:after {
    top: 6px;
  }

  /* 菜单打开时的X图标动画 */
  .greedy-nav .mobile-menu-toggle[aria-expanded="true"] .navicon {
    background: transparent;
  }

  .greedy-nav .mobile-menu-toggle[aria-expanded="true"] .navicon:before {
    transform: rotate(45deg);
    top: 0;
  }

  .greedy-nav .mobile-menu-toggle[aria-expanded="true"] .navicon:after {
    transform: rotate(-45deg);
    top: 0;
  }

  /* 下拉菜单样式 */
  .greedy-nav .hidden-links {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    margin: 0;
    padding: 0;
    background: var(--global-bg-color);
    border: none;
    border-radius: 0;
    box-shadow: var(--nav-menu-shadow);
    border-top: 1px solid var(--global-border-color);
    
    /* 平滑展开动画 */
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 999;
  }

  /* 菜单展开状态 */
  .greedy-nav .hidden-links:not(.hidden) {
    max-height: 400px;
  }

  /* 移除箭头装饰 */
  .greedy-nav .hidden-links:before,
  .greedy-nav .hidden-links:after {
    display: none;
  }

  /* 下拉菜单项样式 */
  .greedy-nav .hidden-links li {
    display: block;
    border-bottom: 1px solid var(--global-border-color);
  }

  .greedy-nav .hidden-links li:last-child {
    border-bottom: none;
  }

  .greedy-nav .hidden-links a {
    display: block;
    margin: 0;
    padding: 1rem 1.5rem;
    font-size: 1rem;
    font-weight: 500;
    color: var(--global-masthead-link-color);
    text-decoration: none;
    transition: var(--nav-transition);
    position: relative;
  }

  .greedy-nav .hidden-links a:hover,
  .greedy-nav .hidden-links a:focus {
    color: var(--global-masthead-link-color-hover);
    background: var(--global-bg-color-secondary, rgba(0, 0, 0, 0.05));
  }

  /* 主题切换按钮在下拉菜单中的特殊样式 */
  .greedy-nav .hidden-links #theme-toggle a {
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  .greedy-nav .hidden-links #theme-toggle a:before {
    content: '主题切换';
    font-size: 1rem;
  }

  /* 外部链接在下拉菜单中的样式 */
  .greedy-nav .hidden-links .external-link a {
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  .greedy-nav .hidden-links .external-link a:before {
    content: '另一个作品集';
    font-size: 1rem;
  }

  /* 避免下拉菜单项的下划线动画 */
  .greedy-nav .hidden-links a:before {
    display: none;
  }
}

/* ==========================================================================
   通用样式优化
   ========================================================================== */

/* 链接下划线动画（仅桌面端） */
@media (min-width: 769px) {
  .greedy-nav .visible-links a {
    position: relative;
  }

  .greedy-nav .visible-links a:before {
    content: "";
    position: absolute;
    left: 0;
    bottom: 0;
    height: 2px;
    background: var(--global-border-color);
    width: 100%;
    transition: var(--nav-transition);
    transform: scaleX(0);
  }

  .greedy-nav .visible-links a:hover:before {
    transform: scaleX(1);
  }
}

/* 确保导航栏在所有设备上都能正确显示 */
.masthead {
  border-bottom: 1px solid var(--global-border-color);
}

.greedy-nav a {
  color: var(--global-masthead-link-color);
  text-decoration: none;
  transition: var(--nav-transition);
}

.greedy-nav a:hover {
  color: var(--global-masthead-link-color-hover);
}

/* 主题切换按钮样式 */
#theme-toggle button {
  background: transparent;
  border: none;
  cursor: pointer;
  color: var(--global-masthead-link-color);
  font-size: inherit;
  padding: 0;
  margin: 0;
  width: 25px;
  display: flex;
  justify-content: center;
  align-items: center;
  transition: var(--nav-transition);
}

#theme-toggle button:hover {
  color: var(--global-masthead-link-color-hover);
}